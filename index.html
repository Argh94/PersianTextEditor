<!DOCTYPE html>
<html lang="fa">
<head>
  <meta charset="UTF-8">
  <title>ÙˆÛŒØ±Ø§ÛŒØ´Ú¯Ø± Ù…ØªÙ† ÙØ§Ø±Ø³ÛŒ</title>
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <!-- Bootstrap -->
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.rtl.min.css" rel="stylesheet">
  <!-- Font: Vazir -->
  <link href="https://cdn.jsdelivr.net/gh/rastikerdar/vazir-font/dist/font-face.css" rel="stylesheet">
  <!-- Font: Sahel -->
  <link href="https://cdn.fontcdn.ir/Font/Persian/Sahel/Sahel.css" rel="stylesheet">
  <!-- Font: Samim -->
  <link href="https://cdn.fontcdn.ir/Font/Persian/Samim/Samim.css" rel="stylesheet">
  <!-- Font: Shabnam -->
  <link href="https://cdn.fontcdn.ir/Font/Persian/Shabnam/Shabnam.css" rel="stylesheet">
  <!-- Font: Tanha -->
  <link href="https://cdn.fontcdn.ir/Font/Persian/Tanha/Tanha.css" rel="stylesheet">
  <!-- Font: B Nazanin -->
  <link href="https://cdn.fontcdn.ir/Font/Persian/Nazanin/Nazanin.css" rel="stylesheet">
  <!-- Font: B Titr -->
  <link href="https://cdn.fontcdn.ir/Font/Persian/Titr/Titr.css" rel="stylesheet">
  <!-- Font: Nastaliq -->
  <link href="https://cdn.fontcdn.ir/Font/Persian/Nastaliq/Nastaliq.css" rel="stylesheet">
  <!-- Pickr Styles -->
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@simonwep/pickr/dist/themes/classic.min.css" />
  <!-- Bootstrap Icons -->
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.3/font/bootstrap-icons.min.css">
  <!-- jsPDF -->
  <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
  <style>
    body {
      font-family: 'Vazir', sans-serif;
      direction: rtl;
      background: #212529;
      color: #fff;
      transition: all 0.3s ease;
      margin: 0;
      min-height: 100vh;
    }

    /* ØªÙ… Ø±ÙˆØ´Ù† */
    .light-theme {
      background: linear-gradient(135deg, #e0e7ff, #f3f4f6);
      color: #333;
    }
    .light-theme #editor {
      background: #fff;
      border: 1px solid #ccc;
      color: #333;
    }
    .light-theme .form-select, .light-theme .btn {
      background-color: #e9eceåº”ç”¨
      background-color: #e9ecef;
      color: #333;
      border-color: #ccc;
    }
    .light-theme .status-bar {
      color: #555;
    }
    .light-theme .preview {
      background: #f8f9fa;
      border-color: #4CAF50;
    }
    .light-theme .preview-header {
      color: #333;
    }

    #editor {
      min-height: 350px;
      background: #343a40;
      border: 1px solid #555;
      padding: 15px;
      border-radius: 8px;
      outline: none;
      color: #fff;
      box-shadow: 0 2px 5px rgba(0,0,0,0.2);
    }

    .preview {
      min-height: 200px;
      background: #fff;
      color: #333;
      border: 2px solid #4CAF50;
      border-radius: 8px;
      padding: 15px;
      box-shadow: 0 2px 5px rgba(0,0,0,0.2);
    }



    .preview img {
      max-width: 100%;
      height: auto;
      border-radius: 4px;
    }

    .preview-header {
      color: #fff;
      font-size: 1rem;
      margin-bottom: 10px;
      display: flex;
      align-items: center;
      gap: 5px;
    }

    .toolbar button, .toolbar select {
      margin: 4px;
    }

    .form-select, .btn {
      background-color: #495057;
      color: #fff;
      border-color: #666;
      box-shadow: 0 2px 5px rgba(0,0,0,0.2);
      transition: all 0.3s ease;
    }

    .form-select option {
      background-color: #212529;
      color: #fff;
    }

    .btn:hover {
      transform: translateY(-2px);
      filter: brightness(1.1);
    }

    .status-bar {
      font-size: 0.9rem;
      margin-top: 10px;
      color: #ccc;
    }

    #alertContainer {
      position: fixed;
      top: 20px;
      right: 20px;
      left: 20px;
      z-index: 9999;
    }

    .alert {
      animation: slideIn 0.5s ease;
    }
    @keyframes slideIn {
      from { transform: translateX(100%); opacity: 0; }
      to { transform: translateX(0); opacity: 1; }
    }

    /* Ø§Ø³ØªØ§ÛŒÙ„ Ø¨Ø±Ø§ÛŒ Ø¯Ø±Ø¨Ø§Ø±Ù‡ Ù…Ù† Ø¯Ø± Ù¾Ø§ÛŒÛŒÙ† ØµÙØ­Ù‡ */
    .footer {
      text-align: center;
      margin-top: 20px;
      padding: 10px;
    }
    .footer a {
      color: #fff;
      text-decoration: none;
      transition: color 0.3s ease;
    }
    .light-theme .footer a {
      color: #333;
    }
    .footer a:hover {
      color: #4CAF50;
    }

    /* Ø§Ø³ØªØ§ÛŒÙ„ Ø¨Ø±Ø§ÛŒ Ù¾Ù†Ù„ Ø´Ú©Ù„Ú© */
    .emoji-picker {
      position: absolute;
      background: #343a40;
      padding: 10px;
      border-radius: 5px;
      z-index: 1000;
      box-shadow: 0 2px 5px rgba(0,0,0,0.3);
      display: flex;
      flex-wrap: wrap;
      gap: 10px;
      max-width: 200px;
    }
    .light-theme .emoji-picker {
      background: #e9ecef;
    }
    .emoji-picker span {
      cursor: pointer;
      font-size: 1.5rem;
      transition: transform 0.2s;
    }
    .emoji-picker span:hover {
      transform: scale(1.2);
    }
  </style>
</head>
<body>

<div id="alertContainer" class="container"></div>

<div class="container my-4">
  <div class="d-flex justify-content-between align-items-center mb-3">
    <h4 class="mb-0">âœï¸ ÙˆÛŒØ±Ø§ÛŒØ´Ú¯Ø± Ù…ØªÙ† Ø¢Ù†Ù„Ø§ÛŒÙ†</h4>
    <div class="d-flex gap-2">
      <button class="btn btn-sm btn-outline-light" onclick="toggleTheme()" aria-label="ØªØºÛŒÛŒØ± ØªÙ…">
        <i id="themeIcon" class="bi bi-moon"></i>
      </button>
    </div>
  </div>

  <div class="toolbar d-flex flex-wrap mb-3">
    <div class="btn-group me-2 mb-2" role="group">
      <button class="btn btn-outline-primary btn-sm" onclick="execCmd('bold')" aria-label="Ø¨ÙˆÙ„Ø¯ Ú©Ø±Ø¯Ù† Ù…ØªÙ†"><i class="bi bi-type-bold"></i></button>
      <button class="btn btn-outline-primary btn-sm" onclick="execCmd('italic')" aria-label="Ø§ÛŒØªØ§Ù„ÛŒÚ© Ú©Ø±Ø¯Ù† Ù…ØªÙ†"><i class="bi bi-type-italic"></i></button>
      <button class="btn btn-outline-primary btn-sm" onclick="execCmd('underline')" aria-label="Ø²ÛŒØ±Ø®Ø· Ú©Ø±Ø¯Ù† Ù…ØªÙ†"><i class="bi bi-type-underline"></i></button>
    </div>
    <div class="btn-group me-2 mb-2" role="group">
      <button class="btn btn-outline-secondary btn-sm" onclick="execCmd('justifyRight')" aria-label="Ø±Ø§Ø³Øªâ€ŒÚ†ÛŒÙ† Ú©Ø±Ø¯Ù† Ù…ØªÙ†"><i class="bi bi-text-right"></i></button>
      <button class="btn btn-outline-secondary btn-sm" onclick="execCmd('justifyCenter')" aria-label="ÙˆØ³Ø·â€ŒÚ†ÛŒÙ† Ú©Ø±Ø¯Ù† Ù…ØªÙ†"><i class="bi bi-text-center"></i></button>
      <button class="btn btn-outline-secondary btn-sm" onclick="execCmd('justifyLeft')" aria-label="Ú†Ù¾â€ŒÚ†ÛŒÙ† Ú©Ø±Ø¯Ù† Ù…ØªÙ†"><i class="bi bi-text-left"></i></button>
    </div>
    <div class="btn-group me-2 mb-2" role="group">
      <button class="btn btn-outline-success btn-sm" onclick="execCmd('insertOrderedList')" aria-label="Ø§ÛŒØ¬Ø§Ø¯ Ù„ÛŒØ³Øª Ø´Ù…Ø§Ø±Ù‡â€ŒØ¯Ø§Ø±"><i class="bi bi-list-ol"></i></button>
      <button class="btn btn-outline-success btn-sm" onclick="execCmd('insertUnorderedList')" aria-label="Ø§ÛŒØ¬Ø§Ø¯ Ù„ÛŒØ³Øª Ù†Ù‚Ø·Ù‡â€ŒØ¯Ø§Ø±"><i class="bi bi-list-ul"></i></button>
    </div>
    <select class="form-select form-select-sm w-auto me-2 mb-2" onchange="execCmd('fontSize', this.value)" aria-label="Ø§Ù†ØªØ®Ø§Ø¨ Ø§Ù†Ø¯Ø§Ø²Ù‡ ÙÙˆÙ†Øª">
      <option value="">Ø§Ù†Ø¯Ø§Ø²Ù‡</option>
      <option value="1">8</option>
      <option value="2">10</option>
      <option value="3">12</option>
      <option value="4">14</option>
      <option value="5">16</option>
      <option value="6">20</option>
      <option value="7">24</option>
    </select>
    <select class="form-select form-select-sm w-auto me-2 mb-2" onchange="execCmd('fontName', this.value)" aria-label="Ø§Ù†ØªØ®Ø§Ø¨ ÙÙˆÙ†Øª">
      <option value="">ÙÙˆÙ†Øª</option>
      <option value="Vazir">ÙˆØ²ÛŒØ±</option>
      <option value="Sahel">Ø³Ø§Ø­Ù„</option>
      <option value="Samim">ØµÙ…ÛŒÙ…</option>
      <option value="Shabnam">Ø´Ø¨Ù†Ù…</option>
      <option value="Tanha">ØªÙ†Ù‡Ø§</option>
      <option value="B Nazanin">Ù†Ø§Ø²Ù†ÛŒÙ†</option>
      <option value="B Titr">ØªÛŒØªØ±</option>
      <option value="Nastaliq">Ù†Ø³ØªØ¹Ù„ÛŒÙ‚</option>
    </select>
    <!-- Pickr container for text color -->
    <div id="fontColorPicker" class="ms-2 mb-2"></div>
    <!-- Pickr container for background color -->
    <div id="bgColorPicker" class="ms-2 mb-2"></div>
    <div class="btn-group me-2 mb-2" role="group">
      <button class="btn btn-outline-warning btn-sm" onclick="execCmd('undo')" aria-label="Ø¨Ø§Ø²Ú¯Ø´Øª Ø¨Ù‡ Ø¹Ù‚Ø¨"><i class="bi bi-arrow-90deg-left"></i></button>
      <button class="btn btn-outline-warning btn-sm" onclick="execCmd('redo')" aria-label="Ø¬Ù„Ùˆ Ø±ÙØªÙ†"><i class="bi bi-arrow-90deg-right"></i></button>
    </div>
    <button class="btn btn-outline-light btn-sm mb-2" onclick="copyToClipboard()" aria-label="Ú©Ù¾ÛŒ Ú©Ø±Ø¯Ù† Ù…ØªÙ†"><i class="bi bi-clipboard"></i></button>
    <button class="btn btn-outline-danger btn-sm mb-2" onclick="clearEditor()" aria-label="Ù¾Ø§Ú© Ú©Ø±Ø¯Ù† Ù…Ø­ØªÙˆØ§"><i class="bi bi-trash"></i></button>
    <button class="btn btn-outline-info btn-sm mb-2" onclick="loadContent()" aria-label="Ø¨Ø§Ø±Ú¯Ø°Ø§Ø±ÛŒ Ø§Ø² Ø­Ø§ÙØ¸Ù‡"><i class="bi bi-upload"></i></button>
    <button class="btn btn-outline-success btn-sm mb-2" onclick="promptSaveFormat()" aria-label="Ø°Ø®ÛŒØ±Ù‡ ÙØ§ÛŒÙ„"><i class="bi bi-download"></i></button>
    <button class="btn btn-outline-info btn-sm mb-2" onclick="showEmojiPicker()" aria-label="Ø§Ø¶Ø§ÙÙ‡ Ú©Ø±Ø¯Ù† Ø´Ú©Ù„Ú©"><i class="bi bi-emoji-smile"></i></button>
    <button class="btn btn-outline-info btn-sm mb-2" onclick="document.getElementById('imageInput').click()" aria-label="Ø¯Ø±Ø¬ ØªØµÙˆÛŒØ±"><i class="bi bi-image"></i></button>
    <input type="file" id="imageInput" accept="image/*" style="display: none;" onchange="insertImage()">
    <button class="btn btn-outline-light btn-sm mb-2" onclick="toggleFullscreen()" aria-label="Ø­Ø§Ù„Øª ØªÙ…Ø§Ù…â€ŒØµÙØ­Ù‡"><i class="bi bi-arrows-fullscreen"></i></button>
    <button class="btn btn-outline-warning btn-sm mb-2" onclick="checkSpelling()" aria-label="Ø¨Ø±Ø±Ø³ÛŒ Ø§Ù…Ù„Ø§"><i class="bi bi-spellcheck"></i></button>
    <select class="form-select form-select-sm w-auto me-2 mb-2" onchange="insertTemplate(this.value)" aria-label="Ø§Ù†ØªØ®Ø§Ø¨ Ù‚Ø§Ù„Ø¨">
      <option value="">Ù‚Ø§Ù„Ø¨</option>
      <option value="letter">Ù†Ø§Ù…Ù‡ Ø±Ø³Ù…ÛŒ</option>
      <option value="resume">Ø±Ø²ÙˆÙ…Ù‡</option>
      <option value="poem">Ø´Ø¹Ø±</option>
      <option value="note">ÛŒØ§Ø¯Ø¯Ø§Ø´Øª Ø±ÙˆØ²Ø§Ù†Ù‡</option>
    </select>
  </div>

  <div id="editor" contenteditable="true" aria-label="ÙˆÛŒØ±Ø§ÛŒØ´Ú¯Ø± Ù…ØªÙ†"></div>
  <div class="input-group mb-3">
    <span class="input-group-text"><i class="bi bi-file-earmark-arrow-up"></i></span>
    <input type="file" class="form-control" id="fileInput" accept=".txt" onchange="loadFromFile()" aria-label="Ø¢Ù¾Ù„ÙˆØ¯ ÙØ§ÛŒÙ„ Ù…ØªÙ†ÛŒ">
  </div>
  <div class="mt-3">
    <h5 class="preview-header"><i class="bi bi-eye"></i> Ù¾ÛŒØ´â€ŒÙ†Ù…Ø§ÛŒØ´ Ø²Ù†Ø¯Ù‡: Ù…ØªÙ† ÙØ±Ù…Øªâ€ŒØ´Ø¯Ù‡ Ø´Ù…Ø§ Ø§ÛŒÙ†Ø¬Ø§ Ù†Ù…Ø§ÛŒØ´ Ø¯Ø§Ø¯Ù‡ Ù…ÛŒâ€ŒØ´ÙˆØ¯</h5>
    <div class="preview p-3 bg-white text-dark border rounded" id="preview"></div>
  </div>
  <div class="status-bar mt-2" id="statusBar">Ú©Ù„Ù…Ø§Øª: 0 | Ú©Ø§Ø±Ø§Ú©ØªØ±: 0</div>

  <!-- Ø¨Ø®Ø´ Ø¯Ø±Ø¨Ø§Ø±Ù‡ Ù…Ù† Ø¯Ø± Ù¾Ø§ÛŒÛŒÙ† ØµÙØ­Ù‡ -->
  <div class="footer">
    <a href="https://github.com/Argh94" target="_blank"><i class="bi bi-github"></i> Ø¯Ø±Ø¨Ø§Ø±Ù‡ Ù…Ù†</a>
  </div>
</div>

<!-- Bootstrap + Pickr -->
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/@simonwep/pickr/dist/pickr.min.js"></script>

<script>
  const editor = document.getElementById('editor');
  const preview = document.getElementById('preview');
  const statusBar = document.getElementById('statusBar');
  const alertContainer = document.getElementById('alertContainer');
  const themeIcon = document.getElementById('themeIcon');
  let currentBgColor = '#ffffff'; // Ø±Ù†Ú¯ Ù¾Ø³â€ŒØ²Ù…ÛŒÙ†Ù‡ Ù¾ÛŒØ´â€ŒÙØ±Ø¶

  function execCmd(cmd, val = null) {
    document.execCommand(cmd, false, val);
    editor.focus();
    updateStatus();
  }

  function clearEditor() {
    editor.innerHTML = '';
    preview.innerHTML = '';
    preview.style.backgroundColor = currentBgColor;
    updateStatus();
    showAlert('Ù…Ø­ØªÙˆØ§ Ù¾Ø§Ú© Ø´Ø¯.', 'danger');
  }

  function copyToClipboard() {
    const range = document.createRange();
    range.selectNodeContents(editor);
    const selection = window.getSelection();
    selection.removeAllRanges();
    selection.addRange(range);
    document.execCommand("copy");
    selection.removeAllRanges();
    showAlert('Ù…ØªÙ† Ú©Ù¾ÛŒ Ø´Ø¯.', 'success');
  }

  function loadContent() {
    const saved = localStorage.getItem("editorContent");
    if (saved) {
      editor.innerHTML = saved;
      preview.innerHTML = saved;
      preview.style.backgroundColor = currentBgColor;
      updateStatus();
      showAlert('Ù…Ø­ØªÙˆØ§ Ø§Ø² Ø­Ø§ÙØ¸Ù‡ Ø¨Ø§Ø±Ú¯Ø°Ø§Ø±ÛŒ Ø´Ø¯.', 'info');
    } else {
      showAlert('Ù…Ø­ØªÙˆØ§ÛŒÛŒ Ø¨Ø±Ø§ÛŒ Ø¨Ø§Ø±Ú¯Ø°Ø§Ø±ÛŒ ÙˆØ¬ÙˆØ¯ Ù†Ø¯Ø§Ø±Ø¯.', 'warning');
    }
  }

  function downloadText() {
    const blob = new Blob([editor.innerText], { type: "text/plain;charset=utf-8" });
    const link = document.createElement("a");
    link.href = URL.createObjectURL(blob);
    link.download = "text.txt";
    link.click();
    showAlert('ÙØ§ÛŒÙ„ Ù…ØªÙ†ÛŒ Ø¯Ø§Ù†Ù„ÙˆØ¯ Ø´Ø¯.', 'success');
  }

  function saveAsPDF() {
    const { jsPDF } = window.jspdf;
    const doc = new jsPDF();
    doc.addFont('https://cdn.jsdelivr.net/gh/rastikerdar/vazir-font/dist/Vazir.ttf', 'Vazir', 'normal');
    doc.setFont('Vazir');
    doc.setFontSize(12);
    doc.text(editor.innerText, 10, 10, { align: 'right', maxWidth: 190 });
    doc.save('text.pdf');
    showAlert('ÙØ§ÛŒÙ„ PDF Ø¯Ø§Ù†Ù„ÙˆØ¯ Ø´Ø¯.', 'success');
  }

  function promptSaveFormat() {
    const format = prompt('ÙØ§ÛŒÙ„ Ø±Ø§ Ø¨Ø§ Ú†Ù‡ ÙØ±Ù…ØªÛŒ Ø°Ø®ÛŒØ±Ù‡ Ú©Ù†ÛŒØ¯ØŸ (PDF ÛŒØ§ TXT)', 'TXT');
    if (format && format.toLowerCase() === 'pdf') {
      saveAsPDF();
    } else if (format && format.toLowerCase() === 'txt') {
      downloadText();
    } else {
      showAlert('ÙØ±Ù…Øª Ù†Ø§Ù…Ø¹ØªØ¨Ø±. Ù„Ø·ÙØ§Ù‹ PDF ÛŒØ§ TXT Ø§Ù†ØªØ®Ø§Ø¨ Ú©Ù†ÛŒØ¯.', 'warning');
    }
  }

  function loadFromFile() {
    const fileInput = document.getElementById('fileInput');
    const file = fileInput.files[0];
    if (!file) return;

    const reader = new FileReader();
    reader.onload = function (e) {
      editor.innerText = e.target.result;
      preview.innerHTML = e.target.result;
      preview.style.backgroundColor = currentBgColor;
      updateStatus();
      showAlert('ÙØ§ÛŒÙ„ Ø¨Ø§Ø±Ú¯Ø°Ø§Ø±ÛŒ Ø´Ø¯.', 'info');
    };
    reader.readAsText(file);
  }

  function insertImage() {
    const fileInput = document.getElementById('imageInput');
    const file = fileInput.files[0];
    if (!file) return;

    const reader = new FileReader();
    reader.onload = function (e) {
      const img = document.createElement('img');
      img.src = e.target.result;
      img.style.maxWidth = '100%';
      img.style.height = 'auto';
      editor.appendChild(img);
      preview.style.backgroundColor = currentBgColor;
      updateStatus();
      showAlert('ØªØµÙˆÛŒØ± Ø¯Ø±Ø¬ Ø´Ø¯.', 'success');
    };
    reader.readAsDataURL(file);
  }

  function updateStatus() {
    const text = editor.innerText.trim();
    const words = text.split(/\s+/).filter(w => w.length > 0).length;
    const chars = text.length;
    statusBar.innerText = `Ú©Ù„Ù…Ø§Øª: ${words} | Ú©Ø§Ø±Ø§Ú©ØªØ±: ${chars}`;
    preview.innerHTML = editor.innerHTML;
    preview.style.backgroundColor = currentBgColor;
  }

  function showAlert(message, type = 'info') {
    const alert = document.createElement('div');
    alert.className = `alert alert-${type} alert-dismissible fade show mt-2`;
    alert.role = 'alert';
    alert.innerHTML = `${message}
      <button type="button" class="btn-close" data-bs-dismiss="alert" aria-label="Close"></button>`;
    alertContainer.appendChild(alert);
    setTimeout(() => {
      alert.classList.remove('show');
      alert.classList.add('hide');
      setTimeout(() => alert.remove(), 500);
    }, 4000);
  }

  function toggleTheme() {
    document.body.classList.toggle('light-theme');
    const isLightTheme = document.body.classList.contains('light-theme');
    localStorage.setItem('theme', isLightTheme ? 'light' : 'dark');
    themeIcon.className = isLightTheme ? 'bi bi-sun' : 'bi bi-moon';
    showAlert('ØªÙ… ØªØºÛŒÛŒØ± Ú©Ø±Ø¯.', 'info');
  }

  function showEmojiPicker() {
    const emojis = [
      'ğŸ˜Š', 'ğŸ‘', 'â¤ï¸', 'ğŸš€', 'ğŸŒŸ', 'ğŸ˜‚', 'ğŸ˜', 'ğŸ˜',
      'ğŸ±', 'ğŸ¶', 'ğŸ', 'ğŸ•', 'ğŸŒˆ', 'âš½', 'ğŸ®', 'ğŸ¸',
      'âœ¨', 'ğŸ”¥', 'ğŸ’¡', 'ğŸ‰'
    ];
    let emojiList = emojis.map(e => `<span onclick="insertEmoji('${e}')" style="cursor: pointer; font-size: 1.5rem; margin: 5px;">${e}</span>`).join('');
    const existingPicker = document.querySelector('.emoji-picker');
    if (existingPicker) existingPicker.remove();
    editor.insertAdjacentHTML('beforeend', `<div class="emoji-picker">${emojiList}</div>`);
  }

  function insertEmoji(emoji) {
    document.querySelector('.emoji-picker').remove();
    document.execCommand('insertText', false, emoji);
    editor.focus();
    updateStatus();
  }

  function toggleFullscreen() {
    if (!document.fullscreenElement) {
      document.documentElement.requestFullscreen().then(() => {
        showAlert('Ø­Ø§Ù„Øª ØªÙ…Ø§Ù…â€ŒØµÙØ­Ù‡ ÙØ¹Ø§Ù„ Ø´Ø¯.', 'info');
      }).catch(() => {
        showAlert('Ù…Ø±ÙˆØ±Ú¯Ø± Ø´Ù…Ø§ Ø§Ø² Ø­Ø§Ù„Øª ØªÙ…Ø§Ù…â€ŒØµÙØ­Ù‡ Ù¾Ø´ØªÛŒØ¨Ø§Ù†ÛŒ Ù†Ù…ÛŒâ€ŒÚ©Ù†Ø¯.', 'danger');
      });
    } else {
      document.exitFullscreen().then(() => {
        showAlert('Ø­Ø§Ù„Øª ØªÙ…Ø§Ù…â€ŒØµÙØ­Ù‡ ØºÛŒØ±ÙØ¹Ø§Ù„ Ø´Ø¯.', 'info');
      });
    }
  }

  const spellCheckDict = {
    'Ù…ÛŒ Ø´Ù‡': 'Ù…ÛŒØ´Ù‡',
    'Ù†Ù…ÛŒØ¯ÙˆÙ†Ù…': 'Ù†Ù…ÛŒâ€ŒØ¯ÙˆÙ†Ù…',
    'Ø®ÙˆØ¨Ø³Øª': 'Ø®ÙˆØ¨Ù‡',
    'Ø¨Ø§Ø´': 'Ø¨Ø§Ø´Ù‡'
  };

  function checkSpelling() {
    let text = editor.innerHTML;
    for (let wrong in spellCheckDict) {
      const regex = new RegExp(`\\b${wrong}\\b`, 'g');
      text = text.replace(regex, `<span style="color: red; text-decoration: underline;">${spellCheckDict[wrong]}</span>`);
    }
    editor.innerHTML = text;
    preview.innerHTML = text;
    preview.style.backgroundColor = currentBgColor;
    showAlert('Ø§Ù…Ù„Ø§ Ø¨Ø±Ø±Ø³ÛŒ Ø´Ø¯.', 'info');
  }

  function insertTemplate(template) {
    const templates = {
      letter: `
        <div style="font-family: B Nazanin; text-align: right; background-color: ${currentBgColor};">
          <p style="font-size: 14px;">Ø¨Ø³Ù…Ù‡ ØªØ¹Ø§Ù„ÛŒ</p>
          <p style="font-size: 14px;">Ø¬Ù†Ø§Ø¨ Ø¢Ù‚Ø§ÛŒ/Ø®Ø§Ù†Ù… ...<br>Ø¨Ø§ Ø³Ù„Ø§Ù… Ùˆ Ø§Ø­ØªØ±Ø§Ù…ØŒ</p>
          <p style="font-size: 14px;">Ø¨Ø¯ÛŒÙ†â€ŒÙˆØ³ÛŒÙ„Ù‡ ...<br>Ø¨Ø§ ØªØ´Ú©Ø±ØŒ<br>Ø§Ù…Ø¶Ø§</p>
        </div>`,
      resume: `
        <div style="font-family: Sahel; text-align: right; background-color: ${currentBgColor};">
          <h3 style="text-align: center; color: #4CAF50;">Ø±Ø²ÙˆÙ…Ù‡</h3>
          <p style="font-size: 14px;"><b>Ù†Ø§Ù…:</b> ...<br><b>ØªØ­ØµÛŒÙ„Ø§Øª:</b> ...<br><b>Ù…Ù‡Ø§Ø±Øªâ€ŒÙ‡Ø§:</b> ...<br><b>ØªØ¬Ø±Ø¨ÛŒØ§Øª Ú©Ø§Ø±ÛŒ:</b> ...</p>
        </div>`,
      poem: `
        <div style="font-family: Nastaliq; text-align: center; background-color: ${currentBgColor};">
          <p style="font-size: 16px; line-height: 2;">Ø´Ø¹Ø±ÛŒ Ø²ÛŒØ¨Ø§<br>Ø¯Ø± Ø§ÛŒÙ†â€ŒØ¬Ø§ Ø´Ø¹Ø± Ø®ÙˆØ¯ Ø±Ø§ Ø¨Ù†ÙˆÛŒØ³ÛŒØ¯...<br>Ø¨Ø§ ÙÙˆÙ†Øª Ù†Ø³ØªØ¹Ù„ÛŒÙ‚ Ùˆ ØªØ±Ø§Ø² ÙˆØ³Ø·.</p>
        </div>`,
      note: `
        <div style="font-family: B Titr; text-align: right; background-color: ${currentBgColor};">
          <p style="font-size: 14px;"><b>ÛŒØ§Ø¯Ø¯Ø§Ø´Øª Ø±ÙˆØ²Ø§Ù†Ù‡</b><br>ØªØ§Ø±ÛŒØ®: ...<br>Ø§Ù…Ø±ÙˆØ² ...<br>Ø¨Ø±Ù†Ø§Ù…Ù‡â€ŒÙ‡Ø§ÛŒ ÙØ±Ø¯Ø§: ...</p>
        </div>`
    };
    if (templates[template]) {
      editor.innerHTML = templates[template];
      preview.innerHTML = templates[template];
      preview.style.backgroundColor = currentBgColor;
      updateStatus();
      showAlert('Ù‚Ø§Ù„Ø¨ Ø§Ø¶Ø§ÙÙ‡ Ø´Ø¯.', 'success');
    }
  }

  editor.addEventListener('input', updateStatus);
  window.addEventListener('load', () => {
    const savedTheme = localStorage.getItem('theme');
    if (savedTheme === 'light') {
      document.body.classList.add('light-theme');
      themeIcon.className = 'bi bi-sun';
    } else {
      themeIcon.className = 'bi bi-moon';
    }
    editor.focus();
    updateStatus();
  });

  // Pickr setup for text color
  const fontColorPickr = Pickr.create({
    el: '#fontColorPicker',
    theme: 'classic',
    default: '#ffffff',
    swatches: ['#ffffff', '#ff0000', '#00ff00', '#0000ff', '#ffff00'],
    components: {
      preview: true,
      opacity: true,
      hue: true,
      interaction: {
        hex: true,
        rgba: true,
        input: true,
        save: true
      }
    }
  });

  fontColorPickr.on('save', (color) => {
    const selectedColor = color.toHEXA().toString();
    execCmd('foreColor', selectedColor);
    fontColorPickr.hide();
  });

  // Pickr setup for background color
  const bgColorPickr = Pickr.create({
    el: '#bgColorPicker',
    theme: 'classic',
    default: '#ffffff',
    swatches: ['#ffffff', '#ffcccc', '#ccffcc', '#ccccff', '#ffffcc'],
    components: {
      preview: true,
      opacity: true,
      hue: true,
      interaction: {
        hex: true,
        rgba: true,
        input: true,
        save: true
      }
    }
  });

  bgColorPickr.on('save', (color) => {
    currentBgColor = color.toHEXA().toString();
    execCmd('backColor', currentBgColor);
    preview.style.backgroundColor = currentBgColor;
    editor.style.backgroundColor = currentBgColor;
    updateStatus();
    bgColorPickr.hide();
  });
</script>

</body>
</html>
